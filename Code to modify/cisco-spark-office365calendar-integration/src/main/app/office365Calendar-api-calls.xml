<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:vm="http://www.mulesoft.org/schema/mule/vm"
	xmlns:metadata="http://www.mulesoft.org/schema/mule/metadata"
	xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:spring="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd">

	<http:request-config name="HTTP_Access_Token_Request_Configuration"
		protocol="HTTPS" host="${office365Calendar.api.access.token.host}"
		port="${office365Calendar.api.access.token.port}" doc:name="HTTP Request Configuration"
		basePath="${office365Calendar.api.access.token.base.path}"
		responseTimeout="400000" />

	<http:request-config name="HTTP_Operations_Request_Configuration"
		protocol="HTTPS" host="${office365Calendar.api.operations.host}" port="${office365Calendar.api.operations.port}"
		basePath="${office365Calendar.api.operations.base.path}" doc:name="HTTP Request Configuration"
		responseTimeout="4000000" />
	<vm:connector name="VM1" validateConnections="true"
		doc:name="VM" />

	<flow name="postoffice365CalendarTokenFlow">
		<set-payload
			value="#[{&quot;code&quot;:flowVars.tokenRequest.authSettings.code,&quot;client_id&quot;:&quot;${office365Calendar.integration.client.id}&quot;,&quot;client_secret&quot;:&quot;${office365Calendar.integration.client.secret}&quot;,&quot;redirect_uri&quot;:&quot;${office365Calendar.integration.redirecr.uri}&quot;,&quot;grant_type&quot;:&quot;${office365Calendar.integration.grantType}&quot;,&quot;scope&quot;:&quot;${office365Calendar.integration.scopes}&quot;}]"
			doc:name="Set Payload" />
		<http:request config-ref="HTTP_Access_Token_Request_Configuration"
			path="${office365Calendar.api.access.token.path}" method="POST"
			doc:name="Access Token Request">
			<http:request-builder>
				<http:header headerName="Content-Type"
					value="application/x-www-form-urlencoded" />
			</http:request-builder>
			<http:failure-status-code-validator
				values="500..599" />
		</http:request>
		<dw:transform-message doc:name="Transform Response to Json">
			<dw:set-payload resource="classpath:dwScripts/fromPayloadToJson.dwl" />
		</dw:transform-message>
	</flow>
	<flow name="postoffice365CalendarRefreshTokenFlow">
		<set-payload
			value="#[{&quot;refresh_token&quot;:flowVars['refreshToken'],&quot;client_id&quot;:&quot;${office365Calendar.integration.client.id}&quot;,&quot;client_secret&quot;:&quot;${office365Calendar.integration.client.secret}&quot;,&quot;redirect_uri&quot;:&quot;${office365Calendar.integration.redirecr.uri}&quot;,&quot;grant_type&quot;:&quot;${office365Calendar.integration.refresh.grantType}&quot;,&quot;scope&quot;:&quot;${office365Calendar.integration.scopes}&quot;}]"
			doc:name="Set Payload" />
		<http:request config-ref="HTTP_Access_Token_Request_Configuration"
			path="${office365Calendar.api.access.token.path}" method="POST"
			doc:name="Refresh Token Request">
			<http:request-builder>
				<http:header headerName="Content-Type"
					value="application/x-www-form-urlencoded" />
			</http:request-builder>
			<http:failure-status-code-validator
				values="500..599" />
		</http:request>
		<dw:transform-message doc:name="Transform Message To Java">
			<dw:set-payload resource="classpath:dwScripts/fromPayloadToJava.dwl" />
		</dw:transform-message>
	</flow>
	<flow name="statusDisableForAnInstance">
		<dw:transform-message doc:name="Status Disable Message">
			<dw:set-payload resource="classpath:dwScripts/buildStatusDisabledExample.dwl" />
		</dw:transform-message>
		<logger
			message="status Disable = #[message.payloadAs(java.lang.String)]::::::::::::::::#[flowVars['instanceId']]"
			level="DEBUG" doc:name="Logger" />
		<http:request config-ref="HTTP_Integrations_Runtime_Request_Configuration"
			path="/integrations/instances/{instanceId}" method="PUT"
			doc:name="Disable The Status for the instance">
			<http:request-builder>
				<http:uri-param paramName="instanceId" value="#[flowVars['instanceId']]" />
			</http:request-builder>
		</http:request>
	</flow>
	<flow name="getoffice365CalendarsListFlow">
		<http:request config-ref="HTTP_Operations_Request_Configuration"
			path="/me/calendars" method="GET" doc:name="Get Calenders List">
			<http:request-builder>
				<http:header headerName="Authorization" value="Bearer #[flowVars['token']]" />
			</http:request-builder>
		</http:request>
		<dw:transform-message doc:name="Transform Response to Java">
			<dw:set-payload resource="classpath:dwScripts/fromPayloadToJava.dwl" />
		</dw:transform-message>
		<choice-exception-strategy doc:name="Choice Exception Strategy">
			<catch-exception-strategy
				when="exception.causedBy(org.mule.module.http.internal.request.ResponseValidatorException)"
				doc:name="Catch Exception Strategy" logException="false">
				<set-property propertyName="http.status" value="#[400]"
					doc:name="400" />
				<logger
					message="API getCalndrList ==&gt; Exception = #[exception.message] +++++++++++++ payloadAsString = #[message.payloadAs(java.lang.String)] ++++++++ Payload = #[payload]"
					level="INFO" doc:name="Logger" />
				<dw:transform-message doc:name="Transform Message To Java">
					<dw:set-payload resource="classpath:dwScripts/fromPayloadToJava.dwl" />
				</dw:transform-message>
			</catch-exception-strategy>
		</choice-exception-strategy>
	</flow>
	<flow name="getOffice365CalendarUesrFlow">
		<http:request config-ref="HTTP_Operations_Request_Configuration"
			path="/me" method="GET" doc:name="Get Calendar User">
			<http:request-builder>
				<http:header headerName="Authorization" value="Bearer #[flowVars['token']]" />
			</http:request-builder>
		</http:request>
		<dw:transform-message doc:name="Transform Message To Java">
			<dw:set-payload resource="classpath:dwScripts/fromPayloadToJava.dwl" />
		</dw:transform-message>
		<choice-exception-strategy doc:name="Choice Exception Strategy">
			<catch-exception-strategy
				when="exception.causedBy(org.mule.module.http.internal.request.ResponseValidatorException)"
				doc:name="Catch Exception Strategy" logException="false">
				<set-property propertyName="http.status" value="#[400]"
					doc:name="400" />
				<logger
					message="API getUserList==&gt; exception = #[exception.message]  ++++++++++ PayloadAsString = #[message.payloadAs(java.lang.String)] +++++++++++ Payload = #[payload]"
					level="INFO" doc:name="Logger" />
				<dw:transform-message doc:name="Transform Message To Java">
					<dw:set-payload resource="classpath:dwScripts/fromPayloadToJava.dwl" />
				</dw:transform-message>
			</catch-exception-strategy>
		</choice-exception-strategy>
	</flow>
	<flow name="getTokenByChoiceCondition">
		<logger
			message="getTokenByChoice  intgrnId=#[flowVars['integrationId']]+++++++++++++++userId=#[flowVars['userId']]"
			level="DEBUG" doc:name="Logger" />
		<choice doc:name="Choice">
			<when
				expression="#[flowVars['integrationId'] != null &amp;&amp; flowVars['userId'] != null]">
				<enricher target="#[flowVars['integrationTokenResponse']]"
					doc:name="Message Enricher">
					<flow-ref name="getIntegrationTokenFlow" doc:name="getIntegrationTokenFlow" />
				</enricher>
				<choice doc:name="Check Token Result">
					<when
						expression="#[flowVars['integrationTokenResponse'].toString() != '{message=No results}']">
						<choice doc:name="Check Refresh Empty">
							<when
								expression="#[flowVars['integrationTokenResponse'][0]['refreshToken'] != null]">
								<set-variable variableName="refreshToken"
									value="#[flowVars['integrationTokenResponse'][0]['refreshToken']]"
									doc:name="Set Refresh Token" />
								<enricher target="#[flowVars['refreshTokenResponse']]"
									doc:name="Message Enricher">
									<flow-ref name="postoffice365CalendarRefreshTokenFlow"
										doc:name="postoffice365CalendarRefreshTokenFlow" />
								</enricher>
								<choice doc:name="Choice">
									<when
										expression="#[flowVars['refreshTokenResponse'].toString() != '{error=invalid_grant, error_description=Bad Request}']">
										<set-variable variableName="token"
											value="#[flowVars['refreshTokenResponse']['access_token']]"
											doc:name="Set Token" />
										<dw:transform-message doc:name="Build Tear Down Integration Response">
											<dw:set-payload
												resource="classpath:dwScripts/buildTokenFlowReponse.dwl" />
										</dw:transform-message>
									</when>
									<otherwise>
										<dw:transform-message doc:name="Generation Of Access Token Failed">
											<dw:set-payload
												resource="classpath:dwScripts/buildGenerationOfAccessTokenFailed.dwl" />
										</dw:transform-message>
									</otherwise>
								</choice>
							</when>
							<otherwise>
								<dw:transform-message doc:name="Refresh Token Empty">
									<dw:set-payload
										resource="classpath:dwScripts/buildFoundRefreshTokenEmpty.dwl" />
								</dw:transform-message>
							</otherwise>
						</choice>
					</when>
					<otherwise>
						<dw:transform-message doc:name="Token Result Empty">
							<dw:set-payload
								resource="classpath:dwScripts/buildTokenResultEmptyExample.dwl" />
						</dw:transform-message>
					</otherwise>
				</choice>
			</when>
			<otherwise>
				<dw:transform-message doc:name="Uid Or Ingtnid Empty">
					<dw:set-payload
						resource="classpath:dwScripts/buildUserIdOrIngtnIdEmptyExample.dwl" />
				</dw:transform-message>
			</otherwise>
		</choice>
	</flow>


	<flow name="startO365CalendarPollingFlow">
		<http:request config-ref="HTTP_Integrations_Runtime_Request_Configuration"
			path="/integrations/instances" method="GET" doc:name="Get By Integration Id">
			<http:request-builder>
				<http:query-param paramName="integrationId"
					value="${office365Calendar.integration.id}" />
				<http:query-param paramName="status" value="ACTIVE" />



			</http:request-builder>
			<http:failure-status-code-validator
				values="500..599" />
		</http:request>
		<dw:transform-message doc:name="Transform Message To Java">
			<dw:set-variable variableName="instancesPayload"
				resource="classpath:dwScripts/fromPayloadToJava.dwl" />
		</dw:transform-message>
		<choice doc:name="Choice">
			<when
				expression="#[flowVars['instancesPayload'].toString() != '{message=No results}']">
				<set-session-variable variableName="maap"
					value="#[new java.util.HashMap()]" doc:name="Set Maap" />
				<foreach collection="#[flowVars['instancesPayload']]"
					doc:name="Loop All Instances And Add UserIds,InstanceUuids To Maap">
					<choice doc:name="Check UserId Exists">
						<when expression="#[maap.containsKey(payload['userId'])]">
							<expression-component doc:name="Expression To Append Element"><![CDATA[maap.get(payload['userId']).add(payload['instanceUuid'])]]></expression-component>
						</when>
						<otherwise>
							<set-variable variableName="uuidList"
								value="#[new java.util.ArrayList()]" doc:name="Create UUID List" />
							<expression-component doc:name="Expression To Add First Element"><![CDATA[uuidList.add(payload['instanceUuid']);
maap.put(payload['userId'],uuidList)]]></expression-component>
						</otherwise>
					</choice>
				</foreach>
				<set-variable variableName="userIdSet"
					value="#[sessionVars.maap.keySet()]" doc:name="Set UserId Set" />
				<set-variable variableName="userIds"
					value="#[new java.util.ArrayList()]" doc:name="UseId List" />
				<expression-component doc:name="Expression Set to List"><![CDATA[userIds.addAll(flowVars['userIdSet']);]]></expression-component>
				<logger
					message="MapResult=#[sessionVars['maap']]==&gt;userIdArray=#[flowVars['userIds']]"
					level="DEBUG" doc:name="Logger" />
				<foreach collection="#[flowVars['userIds']]" doc:name="Loop All User Ids">
					<set-session-variable variableName="userId"
						value="#[payload]" doc:name="Set UserId" />
					<choice doc:name="Choice">
						<when expression="#[sessionVars['userId'] != empty]">
							<vm:outbound-endpoint exchange-pattern="one-way"
								path="ATPT-flow" connector-ref="VM1" doc:name="AccessToken and PageToken" />
						</when>
						<otherwise>
							<logger level="DEBUG" doc:name="Logger" message="UserId Null In go To VM" />
						</otherwise>
					</choice>
				</foreach>
			</when>
			<otherwise>
				<logger message="get by integrationId = #[flowVars['instancesPayload']]"
					level="INFO" doc:name="Logger" />
			</otherwise>
		</choice>


	</flow>


	<flow name="AccessTokenAndPageTokenFlow">
		<vm:inbound-endpoint exchange-pattern="one-way"
			path="ATPT-flow" connector-ref="VM1" doc:name="AccessToken and PageToken" />

		<http:request config-ref="HTTP_Integrations_Runtime_Request_Configuration"
			path="/integrations/{integrationId}/appTokens" method="GET"
			doc:name="Get O365 Access Token">
			<http:request-builder>
				<http:query-param paramName="client_id"
					value="${runtime.clientidenforcement.id}" />
				<http:query-param paramName="client_secret"
					value="${runtime.clientidenforcement.secret}" />
				<http:query-param paramName="userId"
					value="#[sessionVars['userId']]" />
				<http:uri-param paramName="integrationId"
					value="${office365Calendar.integration.id}" />

			</http:request-builder>
			<http:failure-status-code-validator
				values="500..599" />
		</http:request>
		<dw:transform-message doc:name="Transform Message To Java">
			<dw:set-variable variableName="integrationTokenResponse"
				resource="classpath:dwScripts/fromPayloadToJava.dwl" />
		</dw:transform-message>


		<choice doc:name="Token Response">
			<when
				expression="#[flowVars.integrationTokenResponse.toString()=='{message=No results}']">
				<logger level="DEBUG" doc:name="Logger"
					message="token Response = No Results in Polling" />
			</when>
			<otherwise>
				<choice doc:name="Check Refresh Token">
					<when
						expression="#[flowVars['integrationTokenResponse'][0]['refreshToken'] != null]">
						<set-variable variableName="serverTime"
							value="#[(new org.mule.el.datetime.DateTime(server.dateTime)).plusSeconds(300)]"
							doc:name="ServerTime" />
						<set-variable variableName="dbexpire"
							value="#[(new org.mule.el.datetime.DateTime(flowVars['integrationTokenResponse'][0]['expires']))]"
							doc:name="Db Expire" />
						<choice doc:name="Check Access Token Expires">
							<when expression="#[flowVars.serverTime.isAfter(flowVars.dbexpire)]">
								<set-variable variableName="refreshToken"
									value="#[flowVars['integrationTokenResponse'][0]['refreshToken']]"
									doc:name="Set Refresh Token" />
								<set-payload
									value="#[{&quot;refresh_token&quot;:flowVars['refreshToken'],&quot;client_id&quot;:&quot;${office365Calendar.integration.client.id}&quot;,&quot;client_secret&quot;:&quot;${office365Calendar.integration.client.secret}&quot;,&quot;redirect_uri&quot;:&quot;${office365Calendar.integration.redirecr.uri}&quot;,&quot;grant_type&quot;:&quot;${office365Calendar.integration.refresh.grantType}&quot;,&quot;scope&quot;:&quot;${office365Calendar.integration.scopes}&quot;}]"
									doc:name="Refresh Token Body" />

								<http:request config-ref="HTTP_Access_Token_Request_Configuration"
									path="${office365Calendar.api.access.token.path}" method="POST"
									doc:name="GET O365 Access Token">
									<http:request-builder>
										<http:header headerName="Content-Type"
											value="application/x-www-form-urlencoded" />
									</http:request-builder>
									<http:failure-status-code-validator
										values="500..599" />
								</http:request>

								<dw:transform-message doc:name="Transform Message To Java">
									<dw:set-variable variableName="refreshTokenResponse"
										resource="classpath:dwScripts/fromPayloadToJava.dwl" />
								</dw:transform-message>
								<set-variable variableName="expires_in"
									value="#[flowVars['refreshTokenResponse']['expires_in']]"
									doc:name="Set expires_in" />
								<set-variable variableName="GCAccessToken"
									value="#[flowVars['refreshTokenResponse']['access_token']]"
									doc:name="Set AccessToken" />
								<choice doc:name="Check For Revoke Access Token">
									<when
										expression="#[flowVars['expires_in'] != null &amp;&amp; flowVars['GCAccessToken'] != null]">
										<dw:transform-message doc:name="Prepare Json Body">
											<dw:set-payload
												resource="classpath:dwScripts/buildPutAccessTokenForUserInPollingExample.dwl" />
										</dw:transform-message>

										<http:request
											config-ref="HTTP_Integrations_Runtime_Request_Configuration"
											path="/integrations/{integrationId}/appTokens/{appTokenId}"
											method="PUT" doc:name="Put Access Token">
											<http:request-builder>
												<http:query-param paramName="client_id"
													value="${runtime.clientidenforcement.id}" />
												<http:query-param paramName="client_secret"
													value="${runtime.clientidenforcement.secret}" />
												<http:uri-param paramName="integrationId"
													value="${office365Calendar.integration.id}" />
												<http:uri-param paramName="appTokenId"
													value="#[flowVars['integrationTokenResponse'][0]['tokenId']]" />
												<http:header headerName="Content-Type" value="application/json" />



											</http:request-builder>
											<http:failure-status-code-validator
												values="500..599" />
										</http:request>
									</when>
									<otherwise>
										<logger level="DEBUG" doc:name="Logger"
											message="Refresh Token Not success For useId=#[sessionVars['userId']]==&gt;tokenId=#[flowVars['integrationTokenResponse'][0]['tokenId']]" />
									</otherwise>
								</choice>
							</when>
							<otherwise>
								<set-variable variableName="GCAccessToken"
									value="#[flowVars['integrationTokenResponse'][0]['accessToken']]"
									doc:name="AccessToken" />
							</otherwise>
						</choice>
						<http:request config-ref="HTTP_Integrations_Runtime_Request_Configuration"
							path="/office365/settings/{userId}" method="GET"
							doc:name="Get User Last Time From DB">
							<http:request-builder>
								<http:uri-param paramName="userId"
									value="#[sessionVars['userId']]" />
							</http:request-builder>
						</http:request>
						<dw:transform-message doc:name="Transform Message To Java">
							<dw:set-variable variableName="userTimingsResponse"
								resource="classpath:dwScripts/fromPayloadToJava.dwl" />
						</dw:transform-message>
						<choice doc:name="Choice">
							<when
								expression="#[flowVars['userTimingsResponse'].toString() != '{message=No Result Found}']">

								<set-variable variableName="forCrUpServerTimeMinusPollingTime"
									value="#[(new org.mule.el.datetime.DateTime(flowVars['userTimingsResponse'][0]['cursorTime']))]"
									doc:name="Set User Time From DB" />
								<set-variable variableName="time1"
									value="#[server.dateTime.changeTimeZone('UTC')]" doc:name="Set Server Time" />
								<expression-component doc:name="Remove 'Z'"><![CDATA[flowVars['time2'] = flowVars['time1'].toString().split('Z')[0]]]></expression-component>
								<dw:transform-message doc:name="Store DateTime  For User in DB">
									<dw:set-payload
										resource="classpath:dwScripts/buildPutUserTimeStampInPollingExample.dwl" />
								</dw:transform-message>
								<http:request config-ref="HTTP_Integrations_Runtime_Request_Configuration"
									path="/office365/settings/{userId}" method="PUT"
									doc:name="Put Lates Time In DB">
									<http:request-builder>
										<http:uri-param paramName="userId"
											value="#[sessionVars['userId']]" />
									</http:request-builder>
								</http:request>
							</when>
							<otherwise>
								<logger level="DEBUG" doc:name="Logger"
									message="O365 Settings = #[flowVars['userTimingsResponse']] for user #[sessionVars['userId']]" />
							</otherwise>
						</choice>
						<foreach collection="#[sessionVars.maap.get(sessionVars['userId'])]"
							doc:name="Loop All Instance Uuids">

							<set-variable variableName="instanceUuid" value="#[payload]"
								doc:name="Set Instance Uuid" />
							<http:request config-ref="HTTP_Integrations_Runtime_Request_Configuration"
								path="/integrations/instances" method="GET" doc:name="Get By Instance Uuid">
								<http:request-builder>
									<http:query-param paramName="instanceUuid"
										value="#[flowVars['instanceUuid']]" />
									<http:query-param paramName="status" value="ACTIVE" />



								</http:request-builder>
							</http:request>

							<dw:transform-message doc:name="Transform Message To Java">
								<dw:set-variable variableName="instancesUuidResult"
									resource="classpath:dwScripts/fromPayloadToJava.dwl" />
							</dw:transform-message>
							<choice doc:name="Check No Result Condition">
								<when
									expression="#[flowVars['instancesUuidResult'].toString() != '{message=No results}']">
									<set-variable variableName="conf"
										value="#[flowVars['instancesUuidResult'][0]['configJson']]"
										doc:name="Store ConfigJson In Variable" />
									<set-payload value="#[flowVars['conf']]" mimeType="application/json"
										doc:name="Convert ConfigJson To Json" />

									<dw:transform-message doc:name="Transform ConfigJson To Jave">
										<dw:set-variable variableName="configJsonValue"
											resource="classpath:dwScripts/fromPayloadToJava.dwl" />
									</dw:transform-message>

                                    
									<expression-component doc:name="Set Values"><![CDATA[flowVars['timeBasedValue'] =  flowVars['configJsonValue']['time_base'];
flowVars['offValue'] = flowVars['configJsonValue']['offset'];
flowVars['calendarName'] =  flowVars['configJsonValue']['calendar_name'];
flowVars['dayTimeBase'] = flowVars['configJsonValue']['utcTime'];
flowVars['calendar_id'] = flowVars['configJsonValue']['calendar_id'];
flowVars['timezone1']=flowVars['configJsonValue']['timezone'].toString().split('\\(')[1];
flowVars['userTimezone']=flowVars['timezone1'].toString().replace(')','')]]></expression-component>

									<set-variable variableName="startDateTime"
										value="#[(new org.mule.el.datetime.DateTime(server.dateTime)).plusHours(-24)]"
										doc:name="Set Start Date Time" />
									<set-variable variableName="endDateTime"
										value="#[(new org.mule.el.datetime.DateTime(server.dateTime)).plusHours(24)]"
										doc:name="Set End Date Time" />

									<http:request config-ref="HTTP_Operations_Request_Configuration"
										path="/me/calendars/#[flowVars['calendar_id']]/events" method="GET"
										doc:name="Get Calendar Events By Calendar Id">
										<http:request-builder>
                                            <http:query-param paramName="startDateTime" value="#[flowVars['startDateTime']]"/>
                                            <http:query-param paramName="endDateTime" value="#[flowVars['endDateTime']]"/>
                                            <http:header headerName="Authorization" value="Bearer #[flowVars['GCAccessToken']]"/>





										</http:request-builder>
									</http:request>

									<dw:transform-message doc:name="Transform Message To Java">
										<dw:set-variable variableName="GCItemsList"
											resource="classpath:dwScripts/fromPayloadToJava.dwl" />
									</dw:transform-message>

									<choice doc:name="Choice">
										<when expression="#[flowVars['GCItemsList']['value'] != []]">
											<foreach collection="#[flowVars['GCItemsList']['value']]"
												doc:name="Loop All Items">
												<dw:transform-message doc:name="Transform Message To Java">
													<dw:input-payload mimeType="application/java" />
													<dw:set-variable variableName="itemDetails"
														resource="classpath:dwScripts/fromPayloadToJava.dwl" />
												</dw:transform-message>
												<choice doc:name="Check Status Cancelled">
													<when expression="#[flowVars['itemDetails'] != null]">

                                                        <choice doc:name="Check Event Title">
                                                            <when expression="#[flowVars['itemDetails']['Subject'] == null]">
                                                                <set-variable variableName="eventTitle" value="unTitledEvent" doc:name="Set Title To Untitle Event"/>
                                                            </when>
                                                            <otherwise>
                                                                <set-variable variableName="eventTitle" value="#[flowVars['itemDetails']['Subject']]" doc:name="Set Event Title"/>
                                                            </otherwise>
                                                        </choice>
                                                        <expression-component doc:name="Set start Time And End Time"><![CDATA[flowVars['st'] = (new org.mule.el.datetime.DateTime(flowVars['itemDetails']['Start']['DateTime']));
flowVars['et'] = (new org.mule.el.datetime.DateTime(flowVars['itemDetails']['End']['DateTime']))]]></expression-component>
                                                        <set-variable variableName="isAllDayTrue" value="#[flowVars['itemDetails']['IsAllDay']]" doc:name="Is All Day True"/>

		<set-variable variableName="eventOrganizer" value="#[flowVars['itemDetails']['Organizer']['EmailAddress']['Name']] (#[flowVars['itemDetails']['Organizer']['EmailAddress']['Address']])" doc:name="Set Event Organizer Name And Email"/>

		<choice doc:name="Choice">
			<when expression="#[flowVars.offValue.contains('.')]">
				<expression-component doc:name="Split By Dot"><![CDATA[flowVars['splitCondtn'] = flowVars['offValue'].split('\\.');
flowVars['offset1'] = Integer.parseInt(flowVars['splitCondtn'][0]);
flowVars['offset2'] = Integer.parseInt(flowVars['splitCondtn'][1])
]]></expression-component>

				<choice doc:name="Check Minus or Plus">
					<when expression="#[flowVars.offset1.toString().contains('-')]">

						<expression-component doc:name="Split by Minus"><![CDATA[flowVars['minusPlus'] = flowVars['offset1'].toString().split('-');
flowVars['offset3'] = Integer.parseInt(flowVars['minusPlus'][1])]]></expression-component>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['ssub1'] = (new org.mule.el.datetime.DateTime(flowVars['st'])).plusHours(-flowVars['offset3']);
flowVars['esub1'] = (new org.mule.el.datetime.DateTime(flowVars['et'])).plusHours(-flowVars['offset3']);
flowVars['StartTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['ssub1'])).plusMinutes(-flowVars['offset2']);
flowVars['EndTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['esub1'])).plusMinutes(-flowVars['offset2'])]]></expression-component>
					</when>
					<otherwise>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['ssub1'] = (new org.mule.el.datetime.DateTime(flowVars['st'])).plusHours(flowVars['offset1']);
flowVars['esub1'] = (new org.mule.el.datetime.DateTime(flowVars['et'])).plusHours(flowVars['offset1']);
flowVars['StartTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['ssub1'])).plusMinutes(flowVars['offset2']);
flowVars['EndTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['esub1'])).plusMinutes(flowVars['offset2'])]]></expression-component>
					</otherwise>
				</choice>

			</when>
			<otherwise>
				<choice doc:name="Check Minus or Plus For Not Dot">
					<when expression="#[flowVars['offValue'].toString().contains('-')]">

						<expression-component doc:name="Split By Minus"><![CDATA[flowVars['minusPlus'] = flowVars['offValue'].toString().split('-');
flowVars['offValue1'] = Integer.parseInt(flowVars['minusPlus'][1])]]></expression-component>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['StartTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['st'])).plusHours(-flowVars['offValue1']);
flowVars['EndTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['et'])).plusHours(-flowVars['offValue1'])]]></expression-component>
					</when>
					<otherwise>
						<expression-component doc:name="Expression"><![CDATA[flowVars['offValue1'] = Integer.parseInt(flowVars['offValue'])]]></expression-component>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['StartTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['st'])).plusHours(flowVars['offValue1']);
flowVars['EndTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['et'])).plusHours(flowVars['offValue1'])]]></expression-component>
					</otherwise>
				</choice>

			</otherwise>
		</choice>
        <expression-component doc:name="Not All Day and Multi Day"><![CDATA[flowVars['startDate'] = flowVars['StartTimeC'].toString().split('T')[0];
flowVars['getDate'] =  (new org.mule.el.datetime.DateTime(flowVars['startDate'])).format("MMMM d, YYYY");
flowVars['startTime'] = (new org.mule.el.datetime.DateTime(flowVars['StartTimeC'])).format("h:mm a");
flowVars['endDate'] = flowVars['EndTimeC'].toString().split('T')[0];
flowVars['getEndDate'] =  (new org.mule.el.datetime.DateTime(flowVars['endDate'])).format("MMMM d, YYYY");
flowVars['endTime'] = (new org.mule.el.datetime.DateTime(flowVars['EndTimeC'])).format("h:mm a")]]></expression-component>

                                                        <expression-component doc:name="For All Day"><![CDATA[flowVars['curDT'] = flowVars['StartTimeC'].toString().split('T')[0];
flowVars['ADT1'] = flowVars.curDT.concat("T00:00:00Z");
flowVars['ADT2'] = flowVars.curDT.concat("T23:59:59Z");
flowVars['ADTime1'] = (new org.mule.el.datetime.DateTime(flowVars.ADT1)).format("h:mm a");
flowVars['ADDate1'] = (new org.mule.el.datetime.DateTime(flowVars.ADT1)).format("MMMM d, YYYY");
flowVars['ADTime2'] = (new org.mule.el.datetime.DateTime(flowVars.ADT2)).format("h:mm a");
flowVars['ADDate2'] = (new org.mule.el.datetime.DateTime(flowVars.ADT2)).format("MMMM d, YYYY")]]></expression-component>
                                                        <expression-component doc:name="For MultiDay"><![CDATA[flowVars.MDSC = flowVars.StartTimeC.toString().split('T')[0];
flowVars.MDEC = flowVars.EndTimeC.toString().split('T')[0];
flowVars.MDTime1 = (new org.mule.el.datetime.DateTime(flowVars.StartTimeC)).format("h:mm a");
flowVars.MDDate1 = (new org.mule.el.datetime.DateTime(flowVars.StartTimeC)).format("MMMM d, YYYY");
flowVars.MDTime2 = (new org.mule.el.datetime.DateTime(flowVars.EndTimeC)).format("h:mm a");
flowVars.MDDate2 = (new org.mule.el.datetime.DateTime(flowVars.EndTimeC)).format("MMMM d, YYYY")]]></expression-component>

                                                        <expression-component doc:name="Set Crt and upt Time for Compare"><![CDATA[flowVars['crt'] = (new org.mule.el.datetime.DateTime(flowVars['itemDetails']['CreatedDateTime']));
flowVars['updt'] = (new org.mule.el.datetime.DateTime(flowVars['itemDetails']['LastModifiedDateTime']))]]></expression-component>



														<choice doc:name="Check Created Or Updated">
															<when
																expression="#[((flowVars['crt'].isAfter(flowVars['forCrUpServerTimeMinusPollingTime'])) &amp;&amp; (flowVars['crt'].isBefore(server.dateTime.changeTimeZone('UTC'))))]">
																<choice doc:name="Event Create Description And Location Check">
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                        <choice doc:name="Check Is All Day Event">
                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') ']" doc:name="des &amp; Loc Empty"/>
                                                                            </when>
                                                                            <otherwise>
                                                                                <choice doc:name="Check Multi Day">
                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']" doc:name="des &amp; Loc Empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']" doc:name="des &amp; Loc Empty"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                            </otherwise>
                                                                        </choice>

																	</when>
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">
																		<choice doc:name="Check Address Field">
																			<when
																				expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
																				<expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>
                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>

																				<choice doc:name="Check DisplauName contains in address">
																					<when
																						expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>
																					</when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>
                                                                                    </when>
																					<otherwise>
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>
																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
                                                                                <choice doc:name="Check Is All Day">
                                                                                    <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <choice doc:name="Check Multi Day Event">
                                                                                            <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                            </otherwise>
                                                                                        </choice>
                                                                                    </otherwise>
                                                                                </choice>
																			</otherwise>
																		</choice>
																	</when>
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                        <expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																		<choice doc:name="Check Is All Day">
                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Description Preview: '+flowVars['SamplePreview']+'']" doc:name="loc empty"/>
                                                                            </when>
                                                                            <otherwise>
                                                                                <choice doc:name="Check Multi Day">
                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+'']" doc:name="loc empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+'']" doc:name="loc empty"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                            </otherwise>
                                                                        </choice>

																	</when>
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">
																		<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																		<choice doc:name="Check Address Field">
																			<when
																				expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
																				<expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

																				<choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
																				<choice doc:name="Choice">
																					<when
																						expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>
																					</when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'   \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'   \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'   \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>
                                                                                    </when>
																					<otherwise>
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'   \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'   \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'   \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>
																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
                                                                                <choice doc:name="Check Is All Day">
                                                                                    <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <choice doc:name="Check Is Multi Day">
                                                                                            <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was created \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                            </otherwise>
                                                                                        </choice>
                                                                                    </otherwise>
                                                                                </choice>
																			</otherwise>
																		</choice>
																	</when>
																	<otherwise>
																		<logger level="DEBUG" doc:name="Logger"
																			message="default logger for event creation to check des and loc" />
																	</otherwise>
																</choice>
																<set-variable variableName="value" value="eventCreation"
																	doc:name="Create Value" />
															</when>
															<when
																expression="#[((flowVars['updt'].isAfter(flowVars['forCrUpServerTimeMinusPollingTime'])) &amp;&amp; (flowVars['updt'].isBefore(server.dateTime.changeTimeZone('UTC'))))]">
																<choice doc:name="Event Update Description And Location Check">
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                        <choice doc:name="Check Is All Day">
                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') ']" doc:name="des &amp; Loc Empty"/>
                                                                            </when>
                                                                            <otherwise>
                                                                                <choice doc:name="Check Is Multi Day">
                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']" doc:name="des &amp; Loc Empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']" doc:name="des &amp; Loc Empty"/>
                                                                                    </otherwise>
                                                                                </choice>

                                                                            </otherwise>
                                                                        </choice>

																	</when>
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">
																		<choice doc:name="Check Address Field">
																			<when
																				expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
																				<expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

																				<choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
																				<choice doc:name="Choice">
																					<when
																						expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>

																					</when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>

                                                                                    </when>
																					<otherwise>
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>

																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
                                                                                <choice doc:name="Check Is All Day">
                                                                                    <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n -  Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <choice doc:name="Check Is Multi Day">
                                                                                            <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n -  Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n -  Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                            </otherwise>
                                                                                        </choice>

                                                                                    </otherwise>
                                                                                </choice>

																			</otherwise>
																		</choice>
																	</when>
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                        <expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																		<choice doc:name="Check Is All Day">
                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Description Preview: '+flowVars['SamplePreview']+'']" doc:name="loc empty"/>
                                                                            </when>
                                                                            <otherwise>
                                                                                <choice doc:name="Check Is Multi Day">
                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+'']" doc:name="loc empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+'']" doc:name="loc empty"/>
                                                                                    </otherwise>
                                                                                </choice>

                                                                            </otherwise>
                                                                        </choice>

																	</when>
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">
																		<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																		<choice doc:name="Check Address Field">
																			<when
																				expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
																				<expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

																				<choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
																				<choice doc:name="Choice">
																					<when
																						expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>

																					</when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>

                                                                                    </when>
																					<otherwise>
                                                                                        <choice doc:name="Choice">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>

																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
                                                                                <choice doc:name="Check Is All Day">
                                                                                    <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                        <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <choice doc:name="Check Is Multi Day">
                                                                                            <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <set-variable variableName="postMessage" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') was updated \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                            </otherwise>
                                                                                        </choice>

                                                                                    </otherwise>
                                                                                </choice>

																			</otherwise>
																		</choice>
																	</when>
																	<otherwise>
																		<logger level="DEBUG" doc:name="Logger"
																			message="default logger for event updated to check des and loc" />
																	</otherwise>
																</choice>
																<set-variable variableName="value" value="eventUpdate"
																	doc:name="Update Value" />

															</when>

															<otherwise>
																<logger message="default condition for crt or update"
																	level="DEBUG" doc:name="Check crt or update default" />
															</otherwise>
														</choice>
														<choice doc:name="PostMessage Not Null">
															<when expression="#[flowVars['postMessage'] != empty]">
																<set-payload
																	value="#[{&quot;gcMessage&quot;: flowVars['postMessage'],&quot;value&quot;:flowVars['value']}]"
																	doc:name="Prepare Message To Management" />

																<http:request
																	config-ref="HTTP_Integrations_Management_Request_Configuration"
																	path="/hooks/{instanceUuid}" method="POST"
																	doc:name="Hit Management Webhook">
																	<http:request-builder>
																		<http:uri-param paramName="instanceUuid"
																			value="#[flowVars['instanceUuid']]" />


																	</http:request-builder>
																	<http:failure-status-code-validator
																		values="500..599" />
																</http:request>

															</when>
															<otherwise>
																<logger message="postmessg(crt upd tmeBased) null"
																	level="DEBUG" doc:name="Logger" />
															</otherwise>
														</choice>
														<set-variable variableName="postMessage"
															value="" doc:name="Set postMessage To Null" />
														
                                                        
													</when>
													<otherwise>
														<logger message="event Status Canceled" level="DEBUG"
															doc:name="Event Status Canceled" />
													</otherwise>
												</choice>


											</foreach>
											


										</when>
										<otherwise>
											<logger
												message="events value=#[flowVars['GCItemsList']['value']] for user = #[sessionVars['userId']]"
												level="DEBUG" doc:name="Logger" />
										</otherwise>
									</choice>
									<set-variable variableName="ServerDateTimeForDayBased" value="#[server.dateTime]" doc:name="Set Server Date Time"/>
														<choice doc:name="Convert User Time Stamp">
			<when expression="#[flowVars.offValue.contains('.')]">
				<expression-component doc:name="Split By Dot"><![CDATA[flowVars['splitCondtn'] = flowVars['offValue'].split('\\.');
flowVars['offset1'] = Integer.parseInt(flowVars['splitCondtn'][0]);
flowVars['offset2'] = Integer.parseInt(flowVars['splitCondtn'][1])
]]></expression-component>

				<choice doc:name="Check Minus or Plus">
					<when expression="#[flowVars.offset1.toString().contains('-')]">

						<expression-component doc:name="Split by Minus"><![CDATA[flowVars['minusPlus'] = flowVars['offset1'].toString().split('-');
flowVars['offset3'] = Integer.parseInt(flowVars['minusPlus'][1])]]></expression-component>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['sTimeForDB'] = (new org.mule.el.datetime.DateTime(flowVars['ServerDateTimeForDayBased'])).plusHours(-flowVars['offset3']);
flowVars['StartTimeCDB'] = (new org.mule.el.datetime.DateTime(flowVars['sTimeForDB'])).plusMinutes(-flowVars['offset2'])]]></expression-component>
					</when>
					<otherwise>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['sTimeForDB'] = (new org.mule.el.datetime.DateTime(flowVars['ServerDateTimeForDayBased'])).plusHours(flowVars['offset1']);
flowVars['StartTimeCDB'] = (new org.mule.el.datetime.DateTime(flowVars['sTimeForDB'])).plusMinutes(flowVars['offset2'])]]></expression-component>
					</otherwise>
				</choice>

			</when>
			<otherwise>
				<choice doc:name="Check Minus or Plus For Not Dot">
					<when expression="#[flowVars['offValue'].toString().contains('-')]">

						<expression-component doc:name="Split By Minus"><![CDATA[flowVars['minusPlus'] = flowVars['offValue'].toString().split('-');
flowVars['offValue1'] = Integer.parseInt(flowVars['minusPlus'][1])]]></expression-component>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['StartTimeCDB'] = (new org.mule.el.datetime.DateTime(flowVars['ServerDateTimeForDayBased'])).plusHours(-flowVars['offValue1'])
]]></expression-component>
					</when>
					<otherwise>
						<expression-component doc:name="Expression"><![CDATA[flowVars['offValue1'] = Integer.parseInt(flowVars['offValue'])]]></expression-component>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['StartTimeCDB'] = (new org.mule.el.datetime.DateTime(flowVars['ServerDateTimeForDayBased'])).plusHours(flowVars['offValue1'])]]></expression-component>
					</otherwise>
				</choice>

			</otherwise>
		</choice>
                                                        <expression-component doc:name="Expression"><![CDATA[flowVars['startDateDB'] = flowVars['StartTimeCDB'].toString().split('T')[0]]]></expression-component>
														<set-variable variableName="userStartTime1"
															value="#[flowVars['startDateDB']]T00:00:00Z" doc:name="Set User Start Time" />
														<set-variable variableName="userEndTime1"
															value="#[flowVars['startDateDB']]T23:59:00Z" doc:name="Set User End Time" />
                                                        <expression-component doc:name="Expression"><![CDATA[flowVars['userStartTime'] = (new org.mule.el.datetime.DateTime(flowVars['userStartTime1']));
flowVars['userEndTime'] = (new org.mule.el.datetime.DateTime(flowVars['userEndTime1']))]]></expression-component>
									
									<http:request config-ref="HTTP_Operations_Request_Configuration"
										path="/me/calendars/#[flowVars['calendar_id']]/calendarview" method="GET"
										doc:name="Get Calendar Reminders">
										<http:request-builder>
                                            <http:query-param paramName="startDateTime" value="#[flowVars['startDateTime']]"/>
                                            <http:query-param paramName="endDateTime" value="#[flowVars['endDateTime']]"/>
                                            <http:header headerName="Authorization" value="Bearer #[flowVars['GCAccessToken']]"/>





										</http:request-builder>
									</http:request>

									<dw:transform-message doc:name="Transform Message To Java">
										<dw:set-variable variableName="GCItemsList"
											resource="classpath:dwScripts/fromPayloadToJava.dwl" />
									</dw:transform-message>


									<set-variable variableName="remainderArray"
										value="#[new java.util.ArrayList()]" doc:name="Set Remainders Array" />
                                    <choice doc:name="Choice">
                                        <when expression="#[flowVars['GCItemsList']['value'] != []]">
                                            <foreach doc:name="Look Reminders" collection="#[flowVars['GCItemsList']['value']]">
                                                <dw:transform-message doc:name="Transform Message To Java">
													<dw:input-payload mimeType="application/java" />
													<dw:set-variable variableName="itemDetails"
														resource="classpath:dwScripts/fromPayloadToJava.dwl" />
												</dw:transform-message>
                                                <choice doc:name="Choice">
                                                    <when expression="#[flowVars['itemDetails'] != empty]">
                                                        <set-variable variableName="eventStartTime"
															value="#[(new org.mule.el.datetime.DateTime(flowVars['itemDetails']['Start']['DateTime'])).changeTimeZone('UTC')]"
															doc:name="Event Start Time (to Check in time-based)" />
                                                        <choice doc:name="Check Event Title">
                                                            <when expression="#[flowVars['itemDetails']['Subject'] == null]">
                                                                <set-variable variableName="eventTitle" value="unTitledEvent" doc:name="Set Title To Untitle Event"/>
                                                            </when>
                                                            <otherwise>
                                                                <set-variable variableName="eventTitle" value="#[flowVars['itemDetails']['Subject']]" doc:name="Set Event Title"/>
                                                            </otherwise>
                                                        </choice>
                                                        <expression-component doc:name="Set start Time And End Time"><![CDATA[flowVars['st'] = (new org.mule.el.datetime.DateTime(flowVars['itemDetails']['Start']['DateTime']));
flowVars['et'] = (new org.mule.el.datetime.DateTime(flowVars['itemDetails']['End']['DateTime']))]]></expression-component>
                                                        <set-variable variableName="isAllDayTrue" value="#[flowVars['itemDetails']['IsAllDay']]" doc:name="Is All Day True"/>

		<set-variable variableName="eventOrganizer" value="#[flowVars['itemDetails']['Organizer']['EmailAddress']['Name']] (#[flowVars['itemDetails']['Organizer']['EmailAddress']['Address']])" doc:name="Set Event Organizer Name And Email"/>

		<choice doc:name="Convert User Time Stamp">
			<when expression="#[flowVars.offValue.contains('.')]">
				<expression-component doc:name="Split By Dot"><![CDATA[flowVars['splitCondtn'] = flowVars['offValue'].split('\\.');
flowVars['offset1'] = Integer.parseInt(flowVars['splitCondtn'][0]);
flowVars['offset2'] = Integer.parseInt(flowVars['splitCondtn'][1])
]]></expression-component>

				<choice doc:name="Check Minus or Plus">
					<when expression="#[flowVars.offset1.toString().contains('-')]">

						<expression-component doc:name="Split by Minus"><![CDATA[flowVars['minusPlus'] = flowVars['offset1'].toString().split('-');
flowVars['offset3'] = Integer.parseInt(flowVars['minusPlus'][1])]]></expression-component>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['ssub1'] = (new org.mule.el.datetime.DateTime(flowVars['st'])).plusHours(-flowVars['offset3']);
flowVars['esub1'] = (new org.mule.el.datetime.DateTime(flowVars['et'])).plusHours(-flowVars['offset3']);
flowVars['StartTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['ssub1'])).plusMinutes(-flowVars['offset2']);
flowVars['EndTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['esub1'])).plusMinutes(-flowVars['offset2'])]]></expression-component>
					</when>
					<otherwise>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['ssub1'] = (new org.mule.el.datetime.DateTime(flowVars['st'])).plusHours(flowVars['offset1']);
flowVars['esub1'] = (new org.mule.el.datetime.DateTime(flowVars['et'])).plusHours(flowVars['offset1']);
flowVars['StartTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['ssub1'])).plusMinutes(flowVars['offset2']);
flowVars['EndTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['esub1'])).plusMinutes(flowVars['offset2'])]]></expression-component>
					</otherwise>
				</choice>

			</when>
			<otherwise>
				<choice doc:name="Check Minus or Plus For Not Dot">
					<when expression="#[flowVars['offValue'].toString().contains('-')]">

						<expression-component doc:name="Split By Minus"><![CDATA[flowVars['minusPlus'] = flowVars['offValue'].toString().split('-');
flowVars['offValue1'] = Integer.parseInt(flowVars['minusPlus'][1])]]></expression-component>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['StartTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['st'])).plusHours(-flowVars['offValue1']);
flowVars['EndTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['et'])).plusHours(-flowVars['offValue1'])]]></expression-component>
					</when>
					<otherwise>
						<expression-component doc:name="Expression"><![CDATA[flowVars['offValue1'] = Integer.parseInt(flowVars['offValue'])]]></expression-component>
                        <expression-component doc:name="Expression"><![CDATA[flowVars['StartTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['st'])).plusHours(flowVars['offValue1']);
flowVars['EndTimeC'] = (new org.mule.el.datetime.DateTime(flowVars['et'])).plusHours(flowVars['offValue1'])]]></expression-component>
					</otherwise>
				</choice>

			</otherwise>
		</choice>
        <expression-component doc:name="Not All Day Ane Multi Day"><![CDATA[flowVars['startDate'] = flowVars['StartTimeC'].toString().split('T')[0];
flowVars['getDate'] =  (new org.mule.el.datetime.DateTime(flowVars['startDate'])).format("MMMM d, YYYY");
flowVars['startTime'] = (new org.mule.el.datetime.DateTime(flowVars['StartTimeC'])).format("h:mm a");
flowVars['endDate'] = flowVars['EndTimeC'].toString().split('T')[0];
flowVars['getEndDate'] =  (new org.mule.el.datetime.DateTime(flowVars['endDate'])).format("MMMM d, YYYY");
flowVars['endTime'] = (new org.mule.el.datetime.DateTime(flowVars['EndTimeC'])).format("h:mm a")]]></expression-component>

        <expression-component doc:name="For All Day"><![CDATA[flowVars['curDT'] = flowVars['StartTimeC'].toString().split('T')[0];
flowVars['ADT1'] = flowVars.curDT.concat("T00:00:00Z");
flowVars['ADT2'] = flowVars.curDT.concat("T23:59:59Z");
flowVars['ADTime1'] = (new org.mule.el.datetime.DateTime(flowVars.ADT1)).format("h:mm a");
flowVars['ADDate1'] = (new org.mule.el.datetime.DateTime(flowVars.ADT1)).format("MMMM d, YYYY");
flowVars['ADTime2'] = (new org.mule.el.datetime.DateTime(flowVars.ADT2)).format("h:mm a");
flowVars['ADDate2'] = (new org.mule.el.datetime.DateTime(flowVars.ADT2)).format("MMMM d, YYYY")]]></expression-component>
                                                        <expression-component doc:name="For MultiDay"><![CDATA[flowVars.MDSC = flowVars.StartTimeC.toString().split('T')[0];
flowVars.MDEC = flowVars.EndTimeC.toString().split('T')[0];
flowVars.MDTime1 = (new org.mule.el.datetime.DateTime(flowVars.StartTimeC)).format("h:mm a");
flowVars.MDDate1 = (new org.mule.el.datetime.DateTime(flowVars.StartTimeC)).format("MMMM d, YYYY");
flowVars.MDTime2 = (new org.mule.el.datetime.DateTime(flowVars.EndTimeC)).format("h:mm a");
flowVars.MDDate2 = (new org.mule.el.datetime.DateTime(flowVars.EndTimeC)).format("MMMM d, YYYY")]]></expression-component>
        									<choice doc:name="Check User Time-based Value">
															<when expression="#[flowVars['timeBasedValue'] != null]">
																<choice doc:name="Check Time Based Values">
																	<when
																		expression="#[flowVars['timeBasedValue']=='15 minute before']">
																		<set-variable variableName="RTime"
																			value="#[(new org.mule.el.datetime.DateTime(flowVars['eventStartTime'])).plusMinutes(-15).changeTimeZone('UTC')]"
																			doc:name="Reduce Start Time To 15 Mins" />

																		<choice doc:name="15 min">
																			<when
																				expression="#[((flowVars['RTime'].isAfter(flowVars['forCrUpServerTimeMinusPollingTime'])) &amp;&amp; (flowVars['RTime'].isBefore(server.dateTime.changeTimeZone('UTC'))))]">
																				<choice doc:name="15 Mins ==&gt; Des &amp; Loc fields">
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') ']" doc:name="des &amp; loc empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']" doc:name="des &amp; loc empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']" doc:name="des &amp; loc empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>

																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        <choice doc:name="Check Is All Day">
                                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                                    </when>
                                                                                                                    <otherwise>
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                                    </otherwise>
                                                                                                                </choice>

                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        <choice doc:name="Check Is All  Day">
                                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                                                    </when>
                                                                                                                    <otherwise>
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                                                    </otherwise>
                                                                                                                </choice>

                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <choice doc:name="Check Is All Day">
                                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                                    </when>
                                                                                                                    <otherwise>
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des empty"/>
                                                                                                                    </otherwise>
                                                                                                                </choice>

                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                <choice doc:name="Check Is All Day">
                                                                                                    <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <choice doc:name="Check Is Multi Day">
                                                                                                            <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des empty"/>
                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </otherwise>
                                                                                                </choice>

																							</otherwise>
																						</choice>

																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                                        <expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																						<choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="loc empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="loc empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="loc empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>

																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                               <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        <choice doc:name="Check Is All Day">
                                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                                    </when>
                                                                                                                    <otherwise>
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                                    </otherwise>
                                                                                                                </choice>

                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        <choice doc:name="Check Is All Day">
                                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                                    </when>
                                                                                                                    <otherwise>
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                                    </otherwise>
                                                                                                                </choice>

                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <choice doc:name="Check Is All Day">
                                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                                    </when>
                                                                                                                    <otherwise>
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                                    </otherwise>
                                                                                                                </choice>

                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                <choice doc:name="Check Is All Day">
                                                                                                    <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <choice doc:name="Check Is Muti Day">
                                                                                                            <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 15 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </otherwise>
                                                                                                </choice>

																							</otherwise>
																						</choice>

																					</when>
																					<otherwise>
																						<logger level="DEBUG" doc:name="Logger"
																							message="15 mins default choice when checking des and loc" />
																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
																				<logger level="DEBUG" doc:name="15 Min"
																					message="15 min failed" />
																			</otherwise>
																		</choice>
																	</when>
																	<when
																		expression="#[flowVars['timeBasedValue']=='30 minute before']">
																		<set-variable variableName="RTime"
																			value="#[(new org.mule.el.datetime.DateTime(flowVars['eventStartTime'])).plusMinutes(-30).changeTimeZone('UTC')]"
																			doc:name="Reduce Start Time To 30 Mins" />

																		<choice doc:name="30 min">
																			<when
																				expression="#[((flowVars['RTime'].isAfter(flowVars['forCrUpServerTimeMinusPollingTime'])) &amp;&amp; (flowVars['RTime'].isBefore(server.dateTime.changeTimeZone('UTC'))))]">
																				<choice doc:name="30 mins ==&gt; Des and Loc">
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') ']" doc:name="des &amp; loc = empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']" doc:name="des &amp; loc = empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']" doc:name="des &amp; loc = empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>

																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        <choice doc:name="Check Is All Day">
                                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                                    </when>
                                                                                                                    <otherwise>
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                                    </otherwise>
                                                                                                                </choice>
                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        <choice doc:name="Check Is All  Day">
                                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes  \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                                    <when expression="">
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes  \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                                    </when>
                                                                                                                    <otherwise>
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes  \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                                    </otherwise>
                                                                                                                </choice>
                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <choice doc:name="Check Is All Day">
                                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                                    </when>
                                                                                                                    <otherwise>
                                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                                    </otherwise>
                                                                                                                </choice>
                                                                                                            </otherwise>
                                                                                                        </choice>

                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                <choice doc:name="Check Is All Day">
                                                                                                    <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <choice doc:name="Check Is Multi Day">
                                                                                                            <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                            </when>
                                                                                                            <otherwise>
                                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                            </otherwise>
                                                                                                        </choice>
                                                                                                    </otherwise>
                                                                                                </choice>

																							</otherwise>
																						</choice>

																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                                        <expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																						<choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Description Preview:  '+flowVars['SamplePreview']+'']" doc:name="loc = empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview:  '+flowVars['SamplePreview']+'']" doc:name="loc = empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+'']" doc:name="loc = empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>

																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        
                                                                                                        <choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        
                                                                                                    	<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        
                                                                                                    	<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes  \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes  \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes  \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                
																							<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 30 minutes \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																							</otherwise>
																						</choice>

																					</when>
																					<otherwise>
																						<logger level="DEBUG" doc:name="Logger"
																							message="30 mins Default Logger ==&gt; Checking des and loc" />
																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
																				<logger level="DEBUG" doc:name="30 Min"
																					message="30 min failed" />
																			</otherwise>
																		</choice>

																	</when>
																	<when expression="#[flowVars['timeBasedValue']=='1 hour before']">
																		<set-variable variableName="RTime"
																			value="#[(new org.mule.el.datetime.DateTime(flowVars['eventStartTime'])).plusHours(-1).changeTimeZone('UTC')]"
																			doc:name="Reduce Start Time To 1 hour" />

																		<choice doc:name="1 hr">
																			<when
																				expression="#[((flowVars['RTime'].isAfter(flowVars['forCrUpServerTimeMinusPollingTime'])) &amp;&amp; (flowVars['RTime'].isBefore(server.dateTime.changeTimeZone('UTC'))))]">
																				<choice doc:name="1 hr = Des &amp; Loc">
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
																						
																					<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') ']"
																							doc:name="des &amp; loc = empty" />
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']"
																							doc:name="des &amp; loc = empty" />
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') ']"
																							doc:name="des &amp; loc = empty" />
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des == empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des == empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des == empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                
																								<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																							</otherwise>
																						</choice>

																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
																						
																							<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																							<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour  \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Description Preview:  '+flowVars['SamplePreview']+' ']"
																							doc:name="loc empty" />
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour  \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+' ']"
																							doc:name="loc empty" />
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour  \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview:  '+flowVars['SamplePreview']+' ']"
																							doc:name="loc empty" />
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                
																								<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 1 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																							</otherwise>
																						</choice>

																					</when>
																					<otherwise>
																						<logger level="DEBUG" doc:name="Logger"
																							message="1 hr default Logger : Checking Des and Loc" />
																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
																				<logger level="DEBUG" doc:name="1 hr"
																					message="1 hr failed" />
																			</otherwise>
																		</choice>

																	</when>
																	<when expression="#[flowVars['timeBasedValue']=='2 hour before']">
																		<set-variable variableName="RTime"
																			value="#[(new org.mule.el.datetime.DateTime(flowVars['eventStartTime'])).plusHours(-2).changeTimeZone('UTC')]"
																			doc:name="Reduce Start Time To 2 hr" />

																		<choice doc:name="2 hrs">
																			<when
																				expression="#[((flowVars['RTime'].isAfter(flowVars['forCrUpServerTimeMinusPollingTime'])) &amp;&amp; (flowVars['RTime'].isBefore(server.dateTime.changeTimeZone('UTC'))))]">
																				<choice doc:name="2 hrs ==&gt; Des &amp; Loc">
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
																						
																							<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') ']"
																							doc:name="des &amp; loc = empty" />
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  ']"
																							doc:name="des &amp; loc = empty" />
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  ']"
																							doc:name="des &amp; loc = empty" />
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable doc:name="des = empty" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" variableName="postMessage1"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable doc:name="des = empty" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" variableName="postMessage1"/>
                    </when>
                    <otherwise>
                        <set-variable doc:name="des = empty" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" variableName="postMessage1"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                
																								<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour  \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour  \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour  \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																							</otherwise>
																						</choice>

																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
																						
																							<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																							<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Description Preview:  '+flowVars['SamplePreview']+' ']"
																							doc:name="loc = empty" />
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+' ']"
																							doc:name="loc = empty" />
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview:  '+flowVars['SamplePreview']+' ']"
																							doc:name="loc = empty" />
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable doc:name="des &amp; loc != empty" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time : '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" variableName="postMessage1"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable doc:name="des &amp; loc != empty" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time : '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" variableName="postMessage1"/>
                    </when>
                    <otherwise>
                        <set-variable doc:name="des &amp; loc != empty" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time : '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" variableName="postMessage1"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                
																								<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 2 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																							</otherwise>
																						</choice>

																					</when>
																					<otherwise>
																						<logger level="DEBUG" doc:name="Logger"
																							message="2 hrs default : Checking des and loc" />
																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
																				<logger level="DEBUG" doc:name="2 hrs "
																					message="2 hrs failed" />
																			</otherwise>
																		</choice>

																	</when>
																	<when expression="#[flowVars['timeBasedValue']=='4 hour before']">
																		<set-variable variableName="RTime"
																			value="#[(new org.mule.el.datetime.DateTime(flowVars['eventStartTime'])).plusHours(-4).changeTimeZone('UTC')]"
																			doc:name="Reduce Start Time To 4 hrs" />

																		<choice doc:name="4 hrs">
																			<when
																				expression="#[((flowVars['RTime'].isAfter(flowVars['forCrUpServerTimeMinusPollingTime'])) &amp;&amp; (flowVars['RTime'].isBefore(server.dateTime.changeTimeZone('UTC'))))]">
																				<choice doc:name="4 hrs ==&gt; des &amp; loc">
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
																						
																							<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') ']"
																							doc:name="des &amp; loc = empty" />
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')']"
																							doc:name="des &amp; loc = empty" />
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')']"
																							doc:name="des &amp; loc = empty" />
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                
																								<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																							</otherwise>
																						</choice>

																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
																						
																							<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																							<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Description Preview:  '+flowVars['SamplePreview']+' ']"
																							doc:name="loc = empty" />
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+' ']"
																							doc:name="loc = empty" />
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1"
																							value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview:  '+flowVars['SamplePreview']+' ']"
																							doc:name="loc = empty" />
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																					</when>
																					<when
																						expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">

																						<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																						<choice doc:name="Check Address Field">
																							<when expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
                                                                                                <expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

                                                                                                <choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                                                <choice doc:name="Choice">
                                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+')  \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        
																										<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview:  '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
                                                                                                    </otherwise>
                                                                                                </choice>
																							</when>
																							<otherwise>
                                                                                                
																								<choice doc:name="Check Is All Day">
            <when expression="#[flowVars['isAllDayTrue']==true]">
                <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
            </when>
            <otherwise>
                <choice doc:name="Check Is Multi Day">
                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </when>
                    <otherwise>
                        <set-variable variableName="postMessage1" value="#[' ['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') starts in 4 hour \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+'  ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                    </otherwise>
                </choice>
            </otherwise>
        </choice>
																							</otherwise>
																						</choice>

																					</when>
																					<otherwise>
																						<logger level="DEBUG" doc:name="Logger"
																							message="4 hrs default Choice logger : Check des and loc" />
																					</otherwise>
																				</choice>

																			</when>
																			<otherwise>
																				<logger message="4 hrs failed" level="DEBUG"
																					doc:name="Logger" />
																			</otherwise>
																		</choice>

																	</when>

																	<otherwise>
																		<logger
																			message="Default time_based ==&gt; time_based value = #[flowVars['timeBasedValue']]"
																			level="DEBUG" doc:name="Default" />
																	</otherwise>
																</choice>
																<set-variable variableName="TBV"
																	value="timeBasedReminder" doc:name="Time Based Value" />
															</when>
															<otherwise>
																<logger
																	message="Defaul ++++++time_based_value =  #[flowVars['timeBasedValue']]"
																	level="DEBUG" doc:name="End Of TimeBased Choice" />
															</otherwise>
														</choice>
														<choice doc:name="PostMessage Not Null">
															<when expression="#[flowVars['postMessage1'] != empty]">
																<set-payload
																	value="#[{&quot;gcMessage&quot;: flowVars['postMessage1'],&quot;value&quot;:flowVars['TBV']}]"
																	doc:name="Prepare Message To Management" />

																<http:request
																	config-ref="HTTP_Integrations_Management_Request_Configuration"
																	path="/hooks/{instanceUuid}" method="POST"
																	doc:name="Hit Management Webhook">
																	<http:request-builder>
																		<http:uri-param paramName="instanceUuid"
																			value="#[flowVars['instanceUuid']]" />

																	</http:request-builder>
																	<http:failure-status-code-validator
																		values="500..599" />
																</http:request>
															</when>
															<otherwise>
																<logger message="postmessg(crt upd tmeBased) null"
																	level="DEBUG" doc:name="Logger" />
															</otherwise>
														</choice>
                                                        <expression-component doc:name="Event Start Time"><![CDATA[flowVars['startTimeInUtc'] = (new org.mule.el.datetime.DateTime(flowVars['StartTimeC']))]]></expression-component>

														<choice doc:name="Check PostMessage">
															<when
																expression="#[((flowVars['startTimeInUtc'].isAfter(flowVars['userStartTime'])) &amp;&amp; (flowVars['startTimeInUtc'].isBefore(flowVars['userEndTime'])))]">
																<choice doc:name="Reminders ==&gt; des &amp; loc">
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                        <choice doc:name="Check Is All Day">
                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') ']" doc:name="des &amp; loc = empty"/>
                                                                            </when>
                                                                            <otherwise>
                                                                                <choice doc:name="Check Is Multi Day">
                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')']" doc:name="des &amp; loc = empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')']" doc:name="des &amp; loc = empty"/>
                                                                                    </otherwise>
                                                                                </choice>

                                                                            </otherwise>
                                                                        </choice>
																	</when>
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] == empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">
																		<choice doc:name="Check Address Field">
																			<when
																				expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
																				<expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

																				<choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
																				<choice doc:name="Choice">
																					<when
																						expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n -  Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n -  Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n -  Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>
																					</when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>
                                                                                    </when>
																					<otherwise>
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+')  \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+' ']" doc:name="des = empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>

                                                                                            </otherwise>
                                                                                        </choice>
																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
                                                                                <choice doc:name="Check Is All Day">
                                                                                    <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <choice doc:name="Check Is Multi Day">
                                                                                            <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+' ']" doc:name="des = empty"/>
                                                                                            </otherwise>
                                                                                        </choice>

                                                                                    </otherwise>
                                                                                </choice>
																			</otherwise>
																		</choice>

																	</when>
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] == empty]">
                                                                        <expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																		<choice doc:name="Check Is All Day">
                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="loc = empty"/>
                                                                            </when>
                                                                            <otherwise>
                                                                                <choice doc:name="Check Is Multi Day">
                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="loc = empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="loc = empty"/>
                                                                                    </otherwise>
                                                                                </choice>
                                                                            </otherwise>
                                                                        </choice>


																	</when>
																	<when
																		expression="#[flowVars['itemDetails']['BodyPreview'] != empty &amp;&amp; flowVars['itemDetails']['Location']['DisplayName'] != empty]">
																		<expression-component doc:name="Remove '\r\n' from Description Preview"><![CDATA[flowVars['SamplePreview'] = flowVars['itemDetails']['BodyPreview'].toString().replace('\r\n',' ')]]></expression-component>
																		<choice doc:name="Check Address Field">
																			<when
																				expression="#[flowVars['itemDetails']['Location'].containsKey('Address')]">
																				<expression-component doc:name="Get Address"><![CDATA[flowVars['address'] = flowVars['itemDetails']['Location']['Address'].toString().replace('{',' ').replace('}',' ').replace('Street=',' ').replace('City=',' ').replace('State=',' ').replace('CountryOrRegion=',' ').replace(', PostalCode=',' ');
flowVars.address = flowVars.address.replace(' , ','');
flowVars.address = flowVars.address.replace('    ','')]]></expression-component>

																				<choice doc:name="Check Addres empty or Contains ','">
                                                                                    <when expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].toString().endsWith(',')]">
                                                                                        <expression-component doc:name="Expression"><![CDATA[StringBuffer buffer = new StringBuffer(flowVars.address);
flowVars.address = buffer.reverse().toString().replaceFirst(",","");
flowVars.address = new StringBuffer(flowVars.address).reverse().toString()]]></expression-component>
                                                                                    </when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <logger level="DEBUG" doc:name="Logger" message="address empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <logger level="DEBUG" doc:name="Logger" message="default"/>
                                                                                    </otherwise>
                                                                                </choice>
																				<choice doc:name="Choice">
																					<when
																						expression="#[flowVars['address'] != empty &amp;&amp; flowVars['address'].contains(flowVars['itemDetails']['Location']['DisplayName'])]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' \n - Location: '+flowVars['address']+' ('+flowVars['userTimezone']+') \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>

																					</when>
                                                                                    <when expression="#[flowVars['address'] == empty]">
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc ! empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>

                                                                                    </when>
																					<otherwise>
                                                                                        <choice doc:name="Check Is All Day">
                                                                                            <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <choice doc:name="Check Is Multi Day">
                                                                                                    <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                    </when>
                                                                                                    <otherwise>
                                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+'  \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+', '+flowVars['address']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                                    </otherwise>
                                                                                                </choice>
                                                                                            </otherwise>
                                                                                        </choice>

																					</otherwise>
																				</choice>
																			</when>
																			<otherwise>
                                                                                <choice doc:name="Check Is All Day">
                                                                                    <when expression="#[flowVars['isAllDayTrue']==true]">
                                                                                        <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['ADTime1']+' - '+flowVars['ADTime2']+' on '+flowVars['ADDate1']+' ('+flowVars['userTimezone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                    </when>
                                                                                    <otherwise>
                                                                                        <choice doc:name="Check Is Multi Day">
                                                                                            <when expression="#[flowVars['MDSC'] == flowVars['MDEC']]">
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['startTime']+' - '+flowVars['endTime']+' on '+flowVars['getDate']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                            </when>
                                                                                            <otherwise>
                                                                                                <set-variable variableName="reminderMessage" value="#['['+flowVars['eventTitle']+']('+flowVars['itemDetails']['WebLink']+') \n - Organizer: '+flowVars['eventOrganizer']+' \n - Time: '+flowVars['MDDate1']+' - '+flowVars['MDDate2']+' ('+flowVars['itemDetails']['OriginalStartTimeZone']+') \n - Location: '+flowVars['itemDetails']['Location']['DisplayName']+'  \n - Description Preview: '+flowVars['SamplePreview']+' ']" doc:name="des &amp; loc != empty"/>
                                                                                            </otherwise>
                                                                                        </choice>
                                                                                    </otherwise>
                                                                                </choice>

																			</otherwise>
																		</choice>

																	</when>
																	<otherwise>
																		<logger level="DEBUG" doc:name="Logger"
																			message="reminders default : Check des &amp; loc" />
																	</otherwise>
																</choice>
																<expression-component doc:name="Add To Reminder Array"><![CDATA[remainderArray.add(flowVars['reminderMessage'])]]></expression-component>
															</when>
															<otherwise>
																<logger level="DEBUG" doc:name="Logger"
																	message="Add array Condition failed" />

															</otherwise>
														</choice>
														
														<set-variable variableName="postMessage1"
															value="" doc:name="Set postMessage1 To Null" />
                                                    </when>
                                                    <otherwise>
                                                        <logger level="DEBUG" doc:name="Logger" message="#[flowVars['itemDetails']] is empty"/>
                                                    </otherwise>
                                                    
                                                </choice>
                                                
                                            </foreach>
                                            <choice doc:name="Check Day Time Based Value">
												<when
													expression="#[flowVars['dayTimeBase'] != empty &amp;&amp; flowVars['dayTimeBase'] !='NaN:NaN' ]">
													<set-variable variableName="dayBasedTimeStamp"
														value="#[server.dateTime.format('yyyy-MM-dd')]T#[flowVars.dayTimeBase]:00"
														doc:name="Change Day Based To TimeStamp" />
													<set-variable variableName="dayBasedTimeStamp1"
														value="#[(new org.mule.el.datetime.DateTime(flowVars['dayBasedTimeStamp']))]"
														doc:name="Convert DayBased Timestamp From String To Datetime" />

													<choice doc:name="Check Reminder Message">
														<when
															expression="#[(flowVars.remainderArray != []) &amp;&amp; (flowVars['remainderArray'].size() &gt;= 2) &amp;&amp; ((flowVars['dayBasedTimeStamp1'].isAfter(flowVars['forCrUpServerTimeMinusPollingTime'])) &amp;&amp; (flowVars['dayBasedTimeStamp1'].isBefore(server.dateTime.changeTimeZone('UTC'))))]">
															<set-variable variableName="bufferStreamMessage"
																value="#[new java.lang.StringBuffer()]" doc:name="Set A buffer Stream" />
															<set-variable variableName="arraySize"
																value="#[flowVars.remainderArray.size()]" doc:name="Today's events Array Size" />
															<foreach collection="#[flowVars['remainderArray']]"
																doc:name="For Each">
																<choice doc:name="Choice">
																	<when expression="#[flowVars.counter==1]">
																		<set-variable variableName="TodaysMessage"
																			value="#['**There are '+flowVars.arraySize+' events today:** \n \n']"
																			doc:name="TodaysMessage" />
																		<expression-component doc:name="Append To Buffer Stream"><![CDATA[bufferStreamMessage.append(flowVars['TodaysMessage'])]]></expression-component>
																		<expression-component doc:name="Append To Buffer Stream"><![CDATA[bufferStreamMessage.append(payload)]]></expression-component>
																		<expression-component doc:name="Expression"><![CDATA[bufferStreamMessage.append('\n \n')]]></expression-component>
																	</when>
																	<when expression="#[flowVars.counter&gt;1]">
																		<expression-component doc:name="Append To Buffer Stream"><![CDATA[bufferStreamMessage.append(payload)]]></expression-component>
																		<expression-component doc:name="Expression"><![CDATA[bufferStreamMessage.append('\n \n')]]></expression-component>
																	</when>
																	<otherwise>
																		<logger
																			message="for loop day based counter =  #[flowVars.counter]"
																			level="DEBUG" doc:name="Logger" />
																	</otherwise>
																</choice>
															</foreach>
															<set-payload
																value="#[{&quot;gcMessage&quot;: flowVars['bufferStreamMessage'],&quot;value&quot;:&quot;remainders&quot;}]"
																doc:name="Set Remainders Message" />
															<http:request
																config-ref="HTTP_Integrations_Management_Request_Configuration"
																path="/hooks/{instanceUuid}" method="POST"
																doc:name="Send Message To Management">
																<http:request-builder>
																	<http:uri-param paramName="instanceUuid"
																		value="#[flowVars['instanceUuid']]" />
																</http:request-builder>
															</http:request>
														</when>
														<when
															expression="#[(flowVars.remainderArray != []) &amp;&amp; (flowVars['remainderArray'].size() &lt; 2) &amp;&amp; ((flowVars['dayBasedTimeStamp1'].isAfter(flowVars['forCrUpServerTimeMinusPollingTime'])) &amp;&amp; (flowVars['dayBasedTimeStamp1'].isBefore(server.dateTime.changeTimeZone('UTC'))))]">
															<set-variable variableName="bufferStreamMessage"
																value="#[new java.lang.StringBuffer()]" doc:name="Set A buffer Stream" />
															<foreach collection="#[flowVars['remainderArray']]"
																doc:name="For Each">
																<choice doc:name="Choice">
																	<when expression="#[flowVars.counter==1]">
																		<set-variable variableName="TodaysMessage"
																			value="#['**There is an event today:** \n \n']"
																			doc:name="TodaysMessage" />
																		<expression-component doc:name="Append To Buffer Stream"><![CDATA[bufferStreamMessage.append(flowVars['TodaysMessage'])]]></expression-component>
																		<expression-component doc:name="Append To Buffer Stream"><![CDATA[bufferStreamMessage.append(payload)]]></expression-component>
																		<expression-component doc:name="Expression"><![CDATA[bufferStreamMessage.append('\n \n')]]></expression-component>
																	</when>
																	<when expression="#[flowVars.counter&gt;1]">
																		<expression-component doc:name="Append To Buffer Stream"><![CDATA[bufferStreamMessage.append(payload)]]></expression-component>
																		<expression-component doc:name="Expression"><![CDATA[bufferStreamMessage.append('\n \n')]]></expression-component>
																	</when>
																	<otherwise>
																		<logger
																			message="for loop day based counter =  #[flowVars.counter]"
																			level="DEBUG" doc:name="Logger" />
																	</otherwise>
																</choice>
															</foreach>
															<set-payload
																value="#[{&quot;gcMessage&quot;: flowVars['bufferStreamMessage'],&quot;value&quot;:&quot;remainders&quot;}]"
																doc:name="Set Remainders Message" />
															<http:request
																config-ref="HTTP_Integrations_Management_Request_Configuration"
																path="/hooks/{instanceUuid}" method="POST"
																doc:name="Send Message To Management">
																<http:request-builder>
																	<http:uri-param paramName="instanceUuid"
																		value="#[flowVars['instanceUuid']]" />
																</http:request-builder>
															</http:request>
														</when>
														<otherwise>
															<logger
																message="loop all day msgs condition not true : default flow ++++++++  RArray size = #[flowVars['remainderArray'].size()]"
																level="DEBUG" doc:name="Logger" />

														</otherwise>

													</choice>
												</when>
												<otherwise>
													<logger level="DEBUG" doc:name="Logger"
														message="user day based value = #[flowVars['dayTimeBase']]  for userId = #[sessionVars['userId']]" />
												</otherwise>
											</choice>
                                        </when>
                                        <otherwise>
                                            <logger level="DEBUG" doc:name="Logger" message="Calendarview Payload array = #[flowVars['GCItemsList']['value']]"/>
                                        </otherwise>
                                    </choice>


								</when>
								<otherwise>
									<logger message="instanceUuid #[flowVars.instanceUuid]  Inactive"
										level="DEBUG" doc:name="Logger" />
								</otherwise>
							</choice>
						</foreach>


					</when>
					<otherwise>
						<logger level="DEBUG" doc:name="Logger"
							message="refresh Token Null In Polling" />
					</otherwise>
				</choice>
			</otherwise>
		</choice>

		<catch-exception-strategy doc:name="Catch Exception Strategy" logException="false">
			<set-variable variableName="exception" value="#[exception.message]"
				doc:name="exception" />
			<logger
				message="exception in polling for user #[sessionVars['userId']] =  #[flowVars.exception]++++++++++++++"
				level="INFO" doc:name="Logger" />
		</catch-exception-strategy>
	</flow>




</mule>
