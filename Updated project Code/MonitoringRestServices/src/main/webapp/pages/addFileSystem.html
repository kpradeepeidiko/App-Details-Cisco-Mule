<script>
	$(document).ready(function() {

		getFileSystemNames();

	});

	$(function() {
		$('#addFSForm')
				.validate(
						{
							rules : {
								fileSystemNames : {
									required : true
								},

								fileSysHost : {
									required : true
								},
								fileSysMount : {
									required : true
								},
							},
							messages : {
								fileSystemNames : {
									required : "Please select File System Name",
								},
								fileSysHost : {
									required : "Please Enter Host Name"
								},
								fileSysMount : {
									required : "Please Enter File System Mount"
								},
							},

							submitHandler : function(form) {
								var fsData = {};
								fsData.fsName = $("#fileSystemNames").val();
								fsData.fsHost = $("#fileSysHost").val();
								fsData.fsMount = $("#fileSysMount").val();
								fsData.fsPath = $("#fileSysPath").val();
								console.log(JSON.stringify(fsData));
								$
										.ajax({
											type : "POST",
											contentType : "application/json; charset=utf-8",
											url : '/MonitoringRestServices/rest/addFileSystem',
											data : JSON.stringify(fsData),
											dataType : "json",
											headers : getHeadersData(),
											success : function(msg) {
												if (msg.code == 200) {
													var result = '<p class="successMessage">'
															+ msg.message
															+ '</p>';
													$("#rightpanel")
															.load(
																	"pages/fileSystemsList.html",
																	function() {
																		$(
																				"#fsListResults")
																				.html(
																						result);
																		$(
																				"#fsListResults")
																				.removeClass(
																						"alert alert-danger");
																		$(
																				"#fsListResults")
																				.addClass(
																						"alert alert-success");
																	});

												} else {
													var result = '<p class="failureMessage">'
															+ msg.message
															+ '</p>';
													$("#rightpanel")
															.load(
																	"pages/fileSystemsList.html",
																	function() {
																		$(
																				"#fsListResults")
																				.html(
																						result);
																		$(
																				"#fsListResults")
																				.removeClass(
																						"alert alert-success");
																		$(
																				"#fsListResults")
																				.addClass(
																						"alert alert-danger");
																	});
												}
											},
											failure : function(errMsg) {
												var result = '<p class="failureMessage">'
														+ msg.message + '</p>';
												$("#rightpanel")
														.load(
																"pages/fileSystemsList.html",
																function() {
																	$(
																			"#fsListResults")
																			.html(
																					result);
																	$(
																			"#fsListResults")
																			.removeClass(
																					"alert alert-success");
																	$(
																			"#fsListResults")
																			.addClass(
																					"alert alert-danger");
																});
											}

										});

							}
						});
	});

	var getFileSystemNames = null;
	function getFileSystemNames() {
		$.ajax({
			type : "GET",
			contentType : "application/json; charset=utf-8",
			url : "/MonitoringRestServices/rest/fileNamesList" + "?mtime="
					+ mTime,
			dataType : "json",
			headers : getHeadersData(),
			success : function(responseData) {
				getFileSystemNames = responseData;
				$("#addFStable tbody").html("");
				if (responseData.length > 0) {
					console.log("File System List Success");
					$.each(responseData, function() {
						$("#fileSystemNames").append(
								$("<option></option>").val(this['fileName'])
										.html(this['fileName']));
					});
				} else {

				}

				$('input, search').placeholder();
			},
			failure : function(errMsg) {

			}
		});
	}

	$('#fileSystemNames').on('change', function() {
		var fsName = this.value;
		console.log("fsName selected" + fsName);
		console.log("getFileSystemNames" + JSON.stringify(getFileSystemNames));
		if (getFileSystemNames.length != 0) {
			for ( var i in getFileSystemNames) {
				console.log("i.fileName" + getFileSystemNames[i].fileName);
				if (getFileSystemNames[i].fileName == fsName) {
					$("#fileSysPath").val(getFileSystemNames[i].fsPath);
					break;
				} else {
					$("#fileSysPath").val("");
				}
			}
		}

	});

	$("#CancelFileSystemBtn").bind('click', function() {
		$("#rightpanel").load("pages/fileSystemsList.html");
	});
</script>

<h2>Add New File System</h2>
<div id="addFileSystem">
	<form id="addFSForm" action="" class="form-inline" method="post">
		<table class="addFStable table">
			<tbody>
				<tr>
					<td><label>File System Name</label> <br> <select
						name="fileSystemNames" id="fileSystemNames" class="form-control">
							<option value="">select</option>
					</select></td>

					<td colspan="2"><label>Host Name</label><br> <input
						type="text" name="fileSysHost" class="form-control"
						id="fileSysHost" /><br></td>
				</tr>
				<tr>
					<td><label>Mount</label><br> <input type="text"
						class="form-control" name="fileSysMount" id="fileSysMount" /></td>

					<td><label>Path</label><br> <input type="text"
						name="fileSysPath" class="form-control" id="fileSysPath" readonly /></td>
				</tr>
				<tr>
					<td colspan="3"><input type="submit" name="fsSubmit"
						class="btn btn-primary" value="Submit" /> <input type="button"
						id="CancelFileSystemBtn" class="btn btn-info" value="Cancel" /></td>

				</tr>
			</tbody>
		</table>
	</form>
</div>
