<script>
	//storing User Entered Details into userdata
	$(function() {
		$.validator.addMethod("userRegex", function(value, element, regexp) {
			var re = new RegExp(regexp);
			return this.optional(element) || re.test(value);
		});
		$('#adduserform')
				.validate(
						{
							rules : {
								uName : {
									required : true,
									userRegex : /^[A-Za-z0-9_-]+$/
								},
								uPassword : {
									required : true,
									minlength : 4,
									userRegex : /^[A-Za-z0-9_-]+$/

								},
								password_confirm : {
									required : true,
									minlength : 4,
									equalTo : "#uPassword"
								},
								uEmail : {
									required : true,
									email : true
								},
								uMobile : {
									required : true,
									number : true,
									minlength : 10,
									maxlength : 12
								},
							},
							messages : {
								uName : {
									required : "Please Enter User Name",
									userRegex : "Please Enter Valid User Name"
								},
								uPassword : {
									required : "Please Enter Password",
									userRegex : "Please Enter Valid Password"
								},
								password_confirm : {
									required : "Please Enter Confirm Password",
									equalTo : "Please Enter the Same Passwod"
								},
								uEmail : {
									required : "Please Enter a Email Address",
									email : "Please Enter a Valid Email Address"
								},
								uMobile : {
									required : "Please Provide a Mobile Number ",
									minlength : "Your Mobile Number  should be 10 digits",
									number : "Please Enter Only Numbers",
									maxlength : "Your Mobile Number  should be 10 digits"
								},

							},

							submitHandler : function(form) {

								var userData = {};
								userData.id = $("#uId").val();
								userData.name = $("#uName").val();
								userData.password = $("#uPassword").val();
								userData.email = $("#uEmail").val();
								userData.mobileNo = $("#uMobile").val();
								userData.password = $("#uPassword").val();
								userData.sms_flag = $("#userSMSPref").prop(
										'checked');
								userData.email_flag = $("#userEmailPref").prop(
										'checked');
								$
										.ajax({
											type : "POST",
											contentType : "application/json; charset=utf-8",
											url : '/MonitoringRestServices/rest/addUser',
											data : JSON.stringify(userData),
											headers : getHeadersData(),
											success : function(msg) {
												if (msg.code == 200) {

													var result = '<p class="successMessage">'
															+ msg.message
															+ '</p>';
													$("#rightpanel")
															.load(
																	"pages/usersList.html",
																	function() {
																		$(
																				"#userListResults")
																				.html(
																						result);
																		$(
																				"#userListResults")
																				.removeClass(
																						"alert alert-danger");
																		$(
																				"#userListResults")
																				.addClass(
																						"alert alert-success");
																	});

												} else {
													var result = '<p class="failureMessage">'
															+ msg.message
															+ '</p>';
													$("#rightpanel")
															.load(
																	"pages/usersList.html",
																	function() {
																		$(
																				"#userListResults")
																				.html(
																						result);
																		$(
																				"#userListResults")
																				.removeClass(
																						"alert alert-success");
																		$(
																				"#userListResults")
																				.addClass(
																						"alert alert-danger");
																	});

												}
											},
											failure : function(xhr) {
												var result = '<p class="failureMessage">'
														+ xhr.toString()
														+ '</p>';
												$("#rightpanel")
														.load(
																"pages/usersList.html",
																function() {
																	$(
																			"#userListResults")
																			.html(
																					result);
																	$(
																			"#userListResults")
																			.removeClass(
																					"alert alert-success");
																	$(
																			"#userListResults")
																			.addClass(
																					"alert alert-danger");
																});

											},
											dataType : "json"
										});
							}
						});
	});

	//To go back to UserList
	$("#CancelUserBtn").bind('click', function() {
		$("#rightpanel").load("pages/usersList.html");
	});
</script>
<h2>Add New User</h2>
<div id="addUSER">
	<form id="adduserform" action="" class="form-inline" method="post">
		<table class="t1 table">
			<tbody>
				<tr>
					<td><label>User Name</label><br> <input type="text"
						name="uName" class="form-control" id="uName" /></td>
				</tr>
				<tr>
					<td><label>Password</label><br> <input type="password"
						name="uPassword" class="form-control" id="uPassword" /></td>
					<td><label>Confirm Password</label><br> <input
						type="password" name="password_confirm" class="form-control"
						id="password_confirm" /></td>
				</tr>
				<tr>
					<td><label>Email</label><br> <input type="text"
						name="uEmail" class="form-control" id="uEmail" /></td>
				</tr>
				<tr>
					<td><label>Mobile</label><br> <input type="text"
						name="uMobile" id="uMobile" class="form-control" maxlength="12" /></td>
				</tr>
				<tr>
					<td><input type="checkbox" class="userPref" name="userSMSPref"
						id="userSMSPref" /> <label>SMS</label> <input type="checkbox"
						class="userPref" name="userEmailPref" id="userEmailPref" /> <label>E-mail</label>
					</td>
				</tr>
				<tr>
					<td><input type="submit" name="saveuser"
						class="btn btn-primary" value="Save User" id="saveuser" /> <input
						type="button" id="CancelUserBtn" class="btn btn-info"
						name="UserBtn" value="Cancel" /></td>

				</tr>
		</table>
	</form>
	<div id="addUserResult"></div>
</div>

