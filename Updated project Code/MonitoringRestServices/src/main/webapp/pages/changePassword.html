<script>
	$(function() {
		$.validator.addMethod("userNewPwdRegex", function(value, element,
				regexp) {
			var re = new RegExp(regexp);
			return this.optional(element) || re.test(value);
		});
		$('#changePasswordForm')
				.validate(
						{
							rules : {
								newPwd : {
									required : true,
									minlength : 4,
									userNewPwdRegex : /^[A-Za-z0-9_-]+$/
								},
								confirmNewPwd : {
									required : true,
									minlength : 4,
									equalTo : "#newPwd"
								}
							},
							messages : {
								newPwd : {
									required : "Please Enter New Password",
									userOldPwdRegex : "Please Enter Valid Password"
								},
								confirmNewPwd : {
									required : "Please Enter Confirm Password",
									equalTo : "Please Enter Same Password"
								}
							},

							submitHandler : function(form) {

								var userPwdData = {};
								userPwdData.id = loggedUserID;
								userPwdData.password = $("#newPwd").val();
								$
										.ajax({
											type : "POST",
											contentType : "application/json; charset=utf-8",
											url : '/MonitoringRestServices/rest/changePassword',
											data : JSON.stringify(userPwdData),
											headers : getHeadersData(),
											success : function(msg) {
												if (msg.code == 200) {

													var result = '<p class="successMessage">'
															+ msg.message
															+ '</p>';
													$("#changePwdResult").html(
															result);
													$("#changePwdResult")
															.removeClass(
																	"alert alert-danger");
													$("#changePwdResult")
															.addClass(
																	"alert alert-success");
												} else {
													var result = '<p class="failureMessage">'
															+ msg.message
															+ '</p>';
													$("#changePwdResult").html(
															result);
													$("#changePwdResult")
															.removeClass(
																	"alert alert-success");
													$("#changePwdResult")
															.addClass(
																	"alert alert-danger");
												}
											},
											failure : function(xhr) {
												var result = '<p class="failureMessage">'
														+ xhr.toString()
														+ '</p>';
												$("#changePwdResult").html(
														result);
												$("#changePwdResult")
														.removeClass(
																"alert alert-success");
												$("#changePwdResult").addClass(
														"alert alert-danger");
											},
											dataType : "json"
										});
							}
						});
	});
</script>
<h2>Change Password</h2>
<div id="changePassword">
	<form id="changePasswordForm" action="" class="form-inline">
		<table class="changePasswordData table">
			<tbody>
				<tr>
					<td><label>New Password</label><br>
					<input type="password" name="newPwd" id="newPwd"
						class="form-control" /></td>
				</tr>
				<tr>
					<td><label>Confirm New Password</label><br>
					<input type="password" name="confirmNewPwd" id="confirmNewPwd"
						class="form-control" /></td>
				</tr>
				<tr>
					<td colspan="2"><input id="PwdSubmit" type="submit"
						name="PwdSubmit" class="btn btn-primary" value="Submit" /> <input
						id="PwdReset" type="reset" name="PwdReset" class="btn btn-primary"
						value="Reset" /></td>
				</tr>
			</tbody>
		</table>
	</form>
	<div id="changePwdResult"></div>
</div>

